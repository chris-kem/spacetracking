<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Positionsdaten</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">
</head>
<style>
  .links {
    position: relative;
    left: 2%;
  }

  .links1 {
    position: relative;
    left: 2%;
  }

  .rechts {
    position: relative;
    left: 2%;
  }
</style>

<body>
  <!------------------------------------Sensordaten----------------- -->
  <h1 class="links">Sensordaten</h1>
  <fieldset class="links">
    <form>
      <h3>Sensor 1</h3>
      <textarea cols="20" rows="5" id="textfeld1" readonly>Werte für Sensor 1</textarea>
    </form>
    <label for="dropdown1">Wählen Sie eine Funktion:
      <select name="dropdown1" id="dropdown1">
        <option value="linear1">Linear</option>
        <option value="binär1">Binär</option>
        <option value="harfe1">Harfe</option>
      </select>
    </label>
    <fieldset id="schwelle1" style="display:block"><label for="groesse">Schwellenwert:<input id="groesse" type="number"
          min="0" max="1" step=".05" value=".2"></label></fieldset>
    <form>
      <h3 for="textfeld2">Sensor 2</h3>
      <textarea cols="20" rows="5" id="textfeld2" readonly>Werte für Sensor 2</textarea>
    </form>
    <label for="dropdown2">Wählen Sie eine Funktion:</label>
    <select name="dropdown2" id="dropdown2">
      <option value="linear2">Linear</option>
      <option value="binär2">Binär</option>
      <option value="harfe2">Harfe</option>
    </select>
  </fieldset>

  <fieldset class="links1">
    <div>
      <h3>Sensor 3</h3>
      <textarea cols="20" rows="5" id="textfeld3" readonly>Werte für Sensor 3</textarea>
      <label for="dropdown3">Wählen Sie eine Funktion:</label>
      <select name="dropdown3" id="dropdown3">
        <option value="linear3">Linear</option>
        <option value="binär3">Binär</option>
        <option value="harfe3">Harfe</option>
      </select>
    </div>
    <div>
      <h3>Sensor 4</h3>
      <textarea cols="20" rows="5" id="textfeld4" readonly>Werte für Sensor 4</textarea>
      <label for="dropdown4">Wählen Sie eine Funktion:</label>
      <select name="dropdown4" id="dropdown4">
        <option value="linear4">Linear</option>
        <option value="binär4">Binär</option>
        <option value="harfe4">Harfe</option>
      </select>
    </div>
  </fieldset>
  </form>
  <!------------------------------------Positiontracker----------------- -->
  <div class="rechts">
    <h1>Positiontracker</h1>
    <!-- define which picture as floorplan----------------- -->
    <object data="Zeichnung.svg" type="image/svg+xml"></object>
  </div>

  <!--[if IE]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->



  <!-- Add your site or application content here -->
  <script src="js/vendor/modernizr-3.7.1.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script>window.jQuery || document.write('<script src="js/vendor/jquery-3.4.1.min.js"><\/script>')</script>
  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>

  <script src="js/mqtt.js"></script>
  <script src="js/spacetracking.js"></script>

  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID.
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto'); ga('set','transport','beacon'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
  -->


  <script>
    document.getElementById("textfeld1").value = "";
    document.getElementById("textfeld2").value = "";
    document.getElementById("textfeld3").value = "";
    document.getElementById("textfeld4").value = "";
    var newtext1 = "";
    var newtext2 = "";
    var newtext4 = "";
    var newtext3 = "";

    var max_10msg1 = 0;
    var max_10msg3 = 0;
    var max_10msg2 = 0;
    var max_10msg4 = 0;
    // Create a client instance
    var client = mqtt.connect(location.origin.replace(location.protocol, 'ws:') + ":15675");
    client.on('connect', function () { client.subscribe('lasers/#'); });
    //what to do when receiving a mqtt message
    client.on('message', function (topic, msg) {
      //--------------------linear and laserx-------------------------------------
      if (document.getElementById("dropdown1").value == "linear1" && topic == 'lasers/linear/laser0') {
        document.getElementById("schwelle1").style = "display:block"
        if (max_10msg1 <= 10) {
          newtext1 = document.getElementById("textfeld1").value;
          document.getElementById("textfeld1").value = msg + "\n" + newtext1;
          //publish to mqtt topic which sends data via OSC
          client.publish('lasers/OSC/laser0', msg);
          //console.log(msg);
          max_10msg1 += 1;
        } else {
          newtext1 = "";
          max_10msg1 = 0;
        };
      } else if (document.getElementById("dropdown2").value == "linear2" && topic == 'lasers/linear/laser1') {
        if (max_10msg2 <= 10) {
          newtext2 = document.getElementById("textfeld2").value;
          document.getElementById("textfeld2").value = msg + "\n" + newtext2;
          client.publish('lasers/OSC/laser1', msg);
          max_10msg2 += 1;
        } else {
          newtext2 = "";
          max_10msg2 = 0;
        };
      } else if (document.getElementById("dropdown3").value == "linear3" && topic == 'lasers/linear/laser2') {
        if (max_10msg3 <= 10) {
          newtext3 = document.getElementById("textfeld3").value;
          document.getElementById("textfeld3").value = msg + "\n" + newtext3;
          client.publish('lasers/OSC/laser2', msg);
          max_10msg3 += 1;
        } else {
          newtext3 = "";
          max_10msg3 = 0;
        };
      } else if (document.getElementById("dropdown4").value == "linear4" && topic == 'lasers/linear/laser3') {
        if (max_10msg4 <= 10) {
          newtext4 = document.getElementById("textfeld4").value;
          document.getElementById("textfeld4").value = msg + "\n" + newtext4;
          client.publish('lasers/OSC/laser3', msg);
          max_10msg4 += 1;
        } else {
          newtext4 = "";
          max_10msg4 = 0;
        };
        //-------------------------------binary and laserx--------------------------------------------------
      } else if (document.getElementById("dropdown1").value == "binär1" && topic == 'lasers/binary/laser0') {
        document.getElementById("schwelle1").style = "display:none"
        if (max_10msg1 <= 10) {
          newtext1 = document.getElementById("textfeld1").value;
          document.getElementById("textfeld1").value = msg + "\n" + newtext1;
          client.publish('lasers/OSC/laser0', msg);
          //console.log(msg);
          max_10msg1 += 1;
        } else {
          newtext1 = "";
          max_10msg1 = 0;
        };
      } else if (document.getElementById("dropdown2").value == "binär2" && topic == 'lasers/binary/laser1') {
        if (max_10msg2 <= 10) {
          newtext2 = document.getElementById("textfeld2").value;
          document.getElementById("textfeld2").value = msg + "\n" + newtext2;
          client.publish('lasers/OSC/laser1', msg);
          max_10msg2 += 1;
        } else {
          newtext2 = "";
          max_10msg2 = 0;
        };
      } else if (document.getElementById("dropdown3").value == "binär3" && topic == 'lasers/binary/laser2') {
        if (max_10msg3 <= 10) {
          newtext3 = document.getElementById("textfeld3").value;
          document.getElementById("textfeld3").value = msg + "\n" + newtext3;
          client.publish('lasers/OSC/laser2', msg);
          max_10msg3 += 1;
        } else {
          newtext3 = "";
          max_10msg3 = 0;
        };
      } else if (document.getElementById("dropdown4").value == "binär4" && topic == 'lasers/binary/laser3') {
        if (max_10msg4 <= 10) {
          newtext4 = document.getElementById("textfeld4").value;
          document.getElementById("textfeld4").value = msg + "\n" + newtext4;
          client.publish('lasers/OSC/laser3', msg);
          max_10msg4 += 1;
        } else {
          newtext4 = "";
          max_10msg4 = 0;
        };
        //---------------------------------harfe and laserx----------------------------------------------------
      } else if (document.getElementById("dropdown1").value == "harfe1" && topic == 'lasers/harfe/laser0') {
        if (max_10msg1 <= 10) {
          newtext1 = document.getElementById("textfeld1").value;
          document.getElementById("textfeld1").value = msg + "\n" + newtext1;
          client.publish('lasers/OSC/laser0', msg);
          max_10msg1 += 1;
        } else {
          newtext1 = "";
          max_10msg1 = 0;
        };
      } else if (document.getElementById("dropdown2").value == "harfe2" && topic == 'lasers/harfe/laser1') {
        if (max_10msg2 <= 10) {
          newtext2 = document.getElementById("textfeld2").value;
          document.getElementById("textfeld2").value = msg + "\n" + newtext2;
          client.publish('lasers/OSC/laser1', msg);
          max_10msg2 += 1;
        } else {
          newtext2 = "";
          max_10msg2 = 0;
        };
      } else if (document.getElementById("dropdown3").value == "harfe3" && topic == 'lasers/harfe/laser2') {
        if (max_10msg3 <= 10) {
          newtext3 = document.getElementById("textfeld3").value;
          document.getElementById("textfeld3").value = msg + "\n" + newtext3;
          client.publish('lasers/OSC/laser2', msg);
          max_10msg3 += 1;
        } else {
          newtext3 = "";
          max_10msg3 = 0;
        };
      } else if (document.getElementById("dropdown4").value == "harfe4" && topic == 'lasers/harfe/laser3') {
        if (max_10msg4 <= 10) {
          newtext4 = document.getElementById("textfeld4").value;
          document.getElementById("textfeld4").value = msg + "\n" + newtext4;
          client.publish('lasers/OSC/laser3', msg);
          max_10msg4 += 1;
        } else {
          newtext4 = "";
          max_10msg4 = 0;
        };
      };
    });
  </script>
</body>

</html>