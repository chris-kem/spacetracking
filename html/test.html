<!-- To Do:

-->

<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	
	<title>Positionsdaten</title>
	
	<link rel="stylesheet" href="jquery/jquery.mobile-1.4.5.min.css" />
	<script src="jquery/jquery.js"></script>
	<script src="js/plugins.js"></script>
	<script src="js/main.js"></script> 
	<script src="js/mqtt.js"></script>
	
</head>
    <body>
		<h1>Sensordaten</h1>
		
		<form>
			<fieldset>
				<textarea cols="20" rows="5" id="textfeld" readonly></textarea>
			</fieldset>	
		</form>

		  <script>
			// Create a client instance
			var client = new Paho.MQTT.Client(localhost, Number(location.port), "clientId");

			// set callback handlers
			client.onConnectionLost = onConnectionLost;
			client.onMessageArrived = onMessageArrived;

			// connect the client
			client.connect({onSuccess:onConnect});


			// called when the client connects
			function onConnect() {
			// Once a connection has been made, make a subscription and send a message.
			console.log("onConnect");
			client.subscribe("World");
			message = new Paho.MQTT.Message("Hello");
			message.destinationName = "World";
			client.send(message);
			}

			// called when the client loses its connection
			function onConnectionLost(responseObject) {
			if (responseObject.errorCode !== 0) {
				console.log("onConnectionLost:"+responseObject.errorMessage);
			}
			}

			// called when a message arrives
			function onMessageArrived(message) {
			console.log("onMessageArrived:"+message.payloadString);
				window.alert(payload);
				document.getElementById("textfeld").value = payload;
			}
			
		  </script>
    </body>
</html>