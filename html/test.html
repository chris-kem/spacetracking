<!-- To Do:

-->

<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	
	<title>Positionsdaten</title>
	
	<script src="js/plugins.js"></script>
	<script src="js/main.js"></script> 
	<script src="js/mqtt.js"></script>
	
</head>
    <body>
		<h1>Sensordaten</h1>
		
		<form>
				<div>
					<label for="textfeld1">Sensor 1</label>
					<textarea cols="20" rows="5" id="textfeld1" readonly>Werte für Sensor 1</textarea>
					<label for="dropdown1">Wählen Sie eine Funktion:</label>
					<select name="dropdown1" id="dropdown1">
					  <option value="linear1">Linear</option>
					  <option value="binär1">Binär</option>
					  <option value="harfe1">Harfe</option>
					</select> 

					<label for="textfeld2">Sensor 2</label>
					<textarea cols="20" rows="5" id="textfeld2" readonly>Werte für Sensor 2</textarea>
					<label for="dropdown2">Wählen Sie eine Funktion:</label>
					<select name="dropdown2" id="dropdown2">
					  <option value="linear2">Linear</option>
					  <option value="binär2">Binär</option>
					  <option value="harfe2">Harfe</option>
					</select> 
				</div>
				<div>
					<label for="textfeld1">Sensor 1</label>
					<textarea cols="20" rows="5" id="textfeld1" readonly>Werte für Sensor 1</textarea>
					<label for="dropdown1">Wählen Sie eine Funktion:</label>
					<select name="dropdown1" id="dropdown1">
					  <option value="linear1">Linear</option>
					  <option value="binär1">Binär</option>
					  <option value="harfe1">Harfe</option>
					</select> 
				</div>
				<div>
					<label for="textfeld2">Sensor 2</label>
					<textarea cols="20" rows="5" id="textfeld2" readonly>Werte für Sensor 2</textarea>
					<label for="dropdown2">Wählen Sie eine Funktion:</label>
					<select name="dropdown2" id="dropdown2">
					  <option value="linear2">Linear</option>
					  <option value="binär2">Binär</option>
					  <option value="harfe2">Harfe</option>
					</select> 
				</div>	
		</form>

		  <script>
			document.getElementById("textfeld1").value = "";
			document.getElementById("textfeld2").value = "";
			document.getElementById("textfeld3").value = "";
			document.getElementById("textfeld4").value = "";
			var newtext1 = "";
			var newtext2 = "";

			var max_10msg1 = 0;
			// Create a client instance
			var client = mqtt.connect(location.origin.replace(location.protocol, 'ws:') + ":15675");
			client.on('connect', function() { client.subscribe('lasers/#'); });
			//what to do when receiving a mqtt message
			client.on('message', function(topic, msg) {
				if (document.getElementById("dropdown1").value == "linear1" && topic == 'lasers/raw/laser0') {
					if (max_10msg1 <= 10) {
						newtext1 = document.getElementById("textfeld1").value;
						document.getElementById("textfeld1").value = msg + "\n" + newtext1;
						max_10msg1 += 1;
					}else {
						newtext1 = "";
						max_10msg1 = 0;
					};
					//document.getElementById("textfeld").value = msg;
				} else if (topic == 'lasers/raw/laser1') {
					newtext2 = document.getElementById("textfeld2").value;
					document.getElementById("textfeld2").value = msg + "\n" + newtext2;
				};
			});
		  </script>
    </body>
</html>